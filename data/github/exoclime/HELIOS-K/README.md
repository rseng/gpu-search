# https://github.com/exoclime/HELIOS-K

```console
define.h:#define def_maxlines 1048576ll		//maximum number of lines stored on the GPU, Should not be less than maximum in HITEMP lines, must be long long int type
docs/index.rst:| HELIOS-K is running on GPUs and require a Nvidia GPU with compute capability of 3.0 or higher.
docs/helios_k/compilation.rst:| The opacity calculation from HELIOS-K is running on GPUs and require a Nvidia GPUi
docs/helios_k/compilation.rst: with compute capability of 3.0 or higher. It can run on Nvidia Tesla, GeForce and Quadro GPUs.
docs/helios_k/compilation.rst:| The code needs the CUDA toolkit to be installed. This can be downloaded from
docs/helios_k/compilation.rst: https://developer.nvidia.com/cuda-downloads.
docs/helios_k/compilation.rst:capability of the installed GPU. For example use ``make SM=20`` for compute capability 2.0, or ``make SM=35`` for 3.5. A table with all compute capabilities
docs/helios_k/compilation.rst:can be found `here <https://developer.nvidia.com/cuda-gpus>`_.
docs/helios_k/compilation.rst:On a computing cluster, eventually the CUDA module must be loaded before compiling the code.
docs/helios_k/heliosk.rst:-  -dev ``<int>`` : Device number (For multiple GPU systems)
docs/helios_k/heliosk.rst:-  def_nthmax: Maximum number of threads per kernel launch. In 2.0 GPUs
docs/helios_k/heliosk.rst:-  def_maxlines: Maximum number of lines stored on the GPU.
docs/helios_k/heliosk.rst:When using a Desktop GPU running an x session, the runtime of a single
heliosk.cu:// texDescr.filterMode = cudaFilterModeLinear;
heliosk.cu:__global__ void Voigt_texture_kernel(cudaTextureObject_t K2dtex, float *K_d, int Nx, int Ny, int Nxtex, int Nytex, size_t pitch){
heliosk.cu:// texDescr.filterMode = cudaFilterModePoint;
heliosk.cu:__global__ void Voigt_textureb_kernel(cudaTextureObject_t K2dtex, float *K_d, int Nx, int Ny, int Nxtex, int Nytex, size_t pitch){
heliosk.cu:// texDescr.filterMode = cudaFilterModePoint;
heliosk.cu:// texDescr.filterMode = cudaFilterModePoint;
heliosk.cu:__global__ void Voigt_bicubic_kernel(cudaTextureObject_t K2dtex, float *K_d, int Nx, int Ny, int Nxtex, int Nytex, size_t pitch){
heliosk.cu:	cudaError_t error;
heliosk.cu:	cudaGetDeviceCount(&devCount);
heliosk.cu:		printf("Error: No valid cuda device!\n");
heliosk.cu:	if(devCount == 1) printf("There is %d CUDA Device\n", devCount); 
heliosk.cu:	else printf("There are %d CUDA Devices\n", devCount); 
heliosk.cu:cudaMallocPitch((void **) &K2d_d, &pitch, Nxtex * sizeof(double), Nytex);
heliosk.cu:	cudaMemcpy2D(K2d_h, Nxtex * sizeof(double), K2d_d, pitch, Nxtex * sizeof(double), Nytex, cudaMemcpyDeviceToHost);
heliosk.cu:cudaMallocPitch((void **) &K2df_d, &pitchf, Nxtexf * sizeof(float), Nytexf);
heliosk.cu:	cudaMemcpy2D(K2df_h, Nxtexf * sizeof(float), K2df_d, pitchf, Nxtexf * sizeof(float), Nytexf, cudaMemcpyDeviceToHost);
heliosk.cu://https://stackoverflow.com/questions/41749024/edit-cuda-texture-object
heliosk.cu:cudaTextureObject_t K2dtex;
heliosk.cu:cudaResourceDesc resDescr;
heliosk.cu:memset(&resDescr, 0, sizeof(cudaResourceDesc));
heliosk.cu:resDescr.resType = cudaResourceTypePitch2D;
heliosk.cu:resDescr.res.pitch2D.desc = cudaCreateChannelDesc<float>();
heliosk.cu:cudaTextureDesc  texDescr;
heliosk.cu:memset(&texDescr, 0, sizeof(cudaTextureDesc));
heliosk.cu://texDescr.filterMode = cudaFilterModeLinear;
heliosk.cu:texDescr.filterMode = cudaFilterModePoint;
heliosk.cu:texDescr.addressMode[0] = cudaAddressModeClamp;
heliosk.cu:texDescr.addressMode[1] = cudaAddressModeClamp;
heliosk.cu:texDescr.addressMode[2] = cudaAddressModeClamp;
heliosk.cu:texDescr.readMode = cudaReadModeElementType;
heliosk.cu:cudaCreateTextureObject(&K2dtex, &resDescr, &texDescr, NULL);
heliosk.cu:cudaMallocPitch((void **) &K_d, &pitch, Nx * sizeof(float), Ny);
heliosk.cu:cudaMemcpy2D(K_h, Nx * sizeof(float), K_d, pitch, Nx * sizeof(float), Ny, cudaMemcpyDeviceToHost);
heliosk.cu:cudaDeviceSynchronize();
heliosk.cu:	cudaRuntimeGetVersion(&runtimeVersion);
heliosk.cu:	cudaDriverGetVersion(&driverVersion);
heliosk.cu:	cudaSetDevice(param.dev);
heliosk.cu:	cudaDeviceProp devProp;
heliosk.cu:			cudaGetDeviceProperties(&devProp, j);
heliosk.cu:	cudaMalloc((void **) &binBoundaries_d, (param.nbins + 1) * sizeof(double));
heliosk.cu:	cudaMemcpy(binBoundaries_d, binBoundaries_h, (param.nbins + 1) * sizeof(double), cudaMemcpyHostToDevice);
heliosk.cu:	cudaEvent_t tt1;			//start time
heliosk.cu:	cudaEvent_t tt2;			//end time
heliosk.cu:	cudaEventCreate(&tt1);
heliosk.cu:	cudaEventCreate(&tt2);
heliosk.cu:	cudaEvent_t ReadStart, ReadStop;
heliosk.cu:	cudaEventCreate(&ReadStart);
heliosk.cu:	cudaEventCreate(&ReadStop);
heliosk.cu:	cudaEvent_t KStart, KStop;
heliosk.cu:	cudaEventCreate(&KStart);
heliosk.cu:	cudaEventCreate(&KStop);
heliosk.cu:	cudaEvent_t LineStart, LineStop;
heliosk.cu:	cudaEventCreate(&LineStart);
heliosk.cu:	cudaEventCreate(&LineStop);
heliosk.cu:	cudaEvent_t TuneStart, TuneStop;
heliosk.cu:	cudaEventCreate(&TuneStart);
heliosk.cu:	cudaEventCreate(&TuneStop);
heliosk.cu:	cudaEvent_t iiLimitsEvent;
heliosk.cu:	cudaEventCreate(&iiLimitsEvent);
heliosk.cu:	cudaEvent_t AEvent;
heliosk.cu:	cudaEventCreate(&AEvent);
heliosk.cu:	cudaEvent_t ALEvent;
heliosk.cu:	cudaEventCreate(&ALEvent);
heliosk.cu:	cudaEvent_t AREvent;
heliosk.cu:	cudaEventCreate(&AREvent);
heliosk.cu:	cudaEvent_t BEvent;
heliosk.cu:	cudaEventCreate(&BEvent);
heliosk.cu:	cudaStream_t VStream[def_KSn];
heliosk.cu:		cudaStreamCreate(&VStream[i]);
heliosk.cu:	cudaStream_t CStream[def_rBs];
heliosk.cu:		cudaStreamCreate(&CStream[i]);
heliosk.cu:	cudaStream_t tuneStream[2];
heliosk.cu:		cudaStreamCreate(&tuneStream[i]);
heliosk.cu:	cudaStream_t nuLimitsStream[5];
heliosk.cu:		cudaStreamCreate(&nuLimitsStream[i]);
heliosk.cu:	cudaMalloc((void **) &K_d, param.nP * Nx * sizeof(double));
heliosk.cu:	cudaMalloc((void **) &KS_d, def_KSn * Nx * sizeof(double));
heliosk.cu:	cudaMalloc((void **) &x_d, Nx * sizeof(double));
heliosk.cu:	cudaMalloc((void **) &binKey_d, Nx * sizeof(int));
heliosk.cu:	cudaMalloc((void **) &binIndex_d, (param.nbins + 2) * sizeof(int));
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("K alloc error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("bin1 error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaMemcpy(x_h, x_d, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:	cudaMemcpy(binIndex_h, binIndex_d, (param.nbins + 2) * sizeof(int), cudaMemcpyDeviceToHost);
heliosk.cu:	cudaMemcpy(binKey_h, binKey_d, Nx * sizeof(int), cudaMemcpyDeviceToHost);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("K and x alloc error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:		cudaHostAlloc((void **) &readBuffer_h, def_rBs * readBufferSize * readBufferN * sizeof(double), cudaHostAllocDefault);
heliosk.cu:		cudaDeviceSynchronize();
heliosk.cu:		error = cudaGetLastError();
heliosk.cu:			printf("Buffer host alloc error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:		cudaMalloc((void **) &readBuffer_d, def_maxlines * readBufferN * sizeof(double));
heliosk.cu:		cudaDeviceSynchronize();
heliosk.cu:		error = cudaGetLastError();
heliosk.cu:			printf("Buffer device alloc  error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:		cudaDeviceSynchronize();
heliosk.cu:		error = cudaGetLastError();
heliosk.cu:			printf("Initial error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:				cudaMemcpy(K_d + iP * Nx, K_h, Nx * sizeof(double), cudaMemcpyHostToDevice);
heliosk.cu:		cudaDeviceSynchronize();
heliosk.cu:		error = cudaGetLastError();
heliosk.cu:			printf("Line alloc error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:					cudaEventRecord(ReadStart);
heliosk.cu:					cudaEventRecord(ReadStop);
heliosk.cu:					cudaEventSynchronize(ReadStop);
heliosk.cu:					cudaEventElapsedTime(&milliseconds, ReadStart, ReadStop);
heliosk.cu:						cudaEventRecord(LineStart);
heliosk.cu:						cudaDeviceSynchronize();
heliosk.cu:							cudaMemcpy(L.nu_h, L.nu_d, NL * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:						cudaEventRecord(LineStop);
heliosk.cu:						cudaEventSynchronize(LineStop);
heliosk.cu:						error = cudaGetLastError();
heliosk.cu:							printf("Line error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:						cudaEventElapsedTime(&milliseconds, LineStart, LineStop);
heliosk.cu:						cudaEventRecord(KStart);
heliosk.cu:						cudaEventRecord(iiLimitsEvent);
heliosk.cu:						cudaEventSynchronize(iiLimitsEvent);
heliosk.cu:						cudaEventRecord(iiLimitsEvent);
heliosk.cu:						cudaEventSynchronize(iiLimitsEvent);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsA0_h, L.iiLimitsA0_d, nlLimitsA * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[0]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsA1_h, L.iiLimitsA1_d, nlLimitsA * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[0]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsAL0_h, L.iiLimitsAL0_d, nlLimitsA * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[1]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsAL1_h, L.iiLimitsAL1_d, nlLimitsA * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[1]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsAR0_h, L.iiLimitsAR0_d, nlLimitsA * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[2]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsAR1_h, L.iiLimitsAR1_d, nlLimitsA * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[2]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsB0_h, L.iiLimitsB0_d, nlLimitsB * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[3]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsB1_h, L.iiLimitsB1_d, nlLimitsB * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[3]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsC0_h, L.iiLimitsC0_d, nlLimitsC * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[4]);
heliosk.cu:							cudaMemcpyAsync(L.iiLimitsC1_h, L.iiLimitsC1_d, nlLimitsC * sizeof(long long int), cudaMemcpyDeviceToHost, nuLimitsStream[4]);
heliosk.cu:							cudaEventRecord(ReadStart);
heliosk.cu:						cudaDeviceSynchronize();
heliosk.cu:												cudaEventRecord(TuneStart);
heliosk.cu:												cudaEventRecord(TuneStop);
heliosk.cu:												cudaEventSynchronize(TuneStop);
heliosk.cu:												cudaEventElapsedTime(&milliseconds, TuneStart, TuneStop);
heliosk.cu:							cudaEventRecord(AEvent, tuneStream[0]);
heliosk.cu:										int ev =  cudaEventQuery(AEvent);
heliosk.cu:													cudaEventRecord(TuneStart);
heliosk.cu:													cudaEventRecord(TuneStop);
heliosk.cu:													cudaEventSynchronize(TuneStop);
heliosk.cu:													cudaEventElapsedTime(&milliseconds, TuneStart, TuneStop);
heliosk.cu:								cudaEventRecord(ALEvent, tuneStream[0]);
heliosk.cu:											int ev =  cudaEventQuery(ALEvent);
heliosk.cu:													cudaEventRecord(TuneStart);
heliosk.cu:													cudaEventRecord(TuneStop);
heliosk.cu:													cudaEventSynchronize(TuneStop);
heliosk.cu:													cudaEventElapsedTime(&milliseconds, TuneStart, TuneStop);
heliosk.cu:								cudaEventRecord(AREvent, tuneStream[0]);
heliosk.cu:											int ev =  cudaEventQuery(AREvent);
heliosk.cu://cudaDeviceSynchronize();
heliosk.cu:													cudaEventRecord(TuneStart);
heliosk.cu:													cudaEventRecord(TuneStop);
heliosk.cu:													cudaEventSynchronize(TuneStop);
heliosk.cu:													cudaEventElapsedTime(&milliseconds, TuneStart, TuneStop);
heliosk.cu:								cudaEventRecord(BEvent, tuneStream[0]);
heliosk.cu:											int ev =  cudaEventQuery(BEvent);
heliosk.cu:													cudaEventRecord(TuneStart);
heliosk.cu:													cudaEventRecord(TuneStop);
heliosk.cu:													cudaEventSynchronize(TuneStop);
heliosk.cu:													cudaEventElapsedTime(&milliseconds, TuneStart, TuneStop);
heliosk.cu:						error = cudaGetLastError();
heliosk.cu:							printf("K error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:						cudaEventRecord(KStop);
heliosk.cu:							cudaEventRecord(ReadStop);
heliosk.cu:							cudaEventSynchronize(ReadStop);
heliosk.cu:							cudaEventElapsedTime(&milliseconds, ReadStart, ReadStop);
heliosk.cu:								cudaStreamSynchronize(CStream[i]);
heliosk.cu:						cudaDeviceSynchronize();
heliosk.cu:						cudaEventSynchronize(KStop);
heliosk.cu:						cudaEventElapsedTime(&milliseconds, KStart, KStop);
heliosk.cu:						cudaDeviceSynchronize();
heliosk.cu:						error = cudaGetLastError();
heliosk.cu:							printf("Kb error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaFree(binIndex_d);
heliosk.cu:	cudaFree(binBoundaries_d);	
heliosk.cu:	cudaFree(KS_d);
heliosk.cu:	cudaEventRecord(tt1, 0);
heliosk.cu:		cudaStreamDestroy(VStream[i]);
heliosk.cu:		cudaStreamDestroy(CStream[i]);
heliosk.cu:		cudaStreamDestroy(tuneStream[i]);
heliosk.cu:		cudaStreamDestroy(nuLimitsStream[i]);
heliosk.cu:			cudaMemcpy(K_h, K_d + iP * Nx, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:			cudaMemcpy(K_d + iP * Nx, K_h, Nx * sizeof(double), cudaMemcpyHostToDevice);
heliosk.cu:			cudaMemcpy(K_h, K_d + iP * Nx, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:			cudaMemcpy(K_d + iP * Nx, K_h, Nx * sizeof(double), cudaMemcpyHostToDevice);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("Write error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaEventRecord(tt2, 0);
heliosk.cu:	cudaEventSynchronize(tt2);
heliosk.cu:	cudaEventElapsedTime(&milliseconds, tt1, tt2);
heliosk.cu:	cudaEventRecord(tt1, 0);
heliosk.cu:		cudaMalloc((void **) &Pmn_d, Nx * sizeof(double));
heliosk.cu:		cudaMalloc((void **) &Rmn_d, Nx * sizeof(double));
heliosk.cu:		cudaMalloc((void **) &means_d, 4 * sizeof(double));
heliosk.cu:cudaMemcpy(K_h, Pmn_d, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:cudaMemcpy(K_h, Rmn_d, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:			cudaMemcpy(means_h, means_d, 4 * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:		cudaFree(means_d);
heliosk.cu:		cudaFree(Pmn_d);
heliosk.cu:		cudaFree(Rmn_d);
heliosk.cu:	cudaFree(x_d);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("maen error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaEventRecord(tt2, 0);
heliosk.cu:	cudaEventSynchronize(tt2);
heliosk.cu:	cudaEventElapsedTime(&milliseconds, tt1, tt2);
heliosk.cu:	cudaEventRecord(tt1, 0);
heliosk.cu:	cudaFree(binKey_d);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("Sort error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaEventRecord(tt2, 0);
heliosk.cu:	cudaEventSynchronize(tt2);
heliosk.cu:	cudaEventElapsedTime(&milliseconds, tt1, tt2);
heliosk.cu:	cudaEventRecord(tt1, 0);
heliosk.cu://cudaMemGetInfo( &free_byte, &total_byte );
heliosk.cu:	cudaMalloc((void **) &Nxmin_d, param.nbins * sizeof(int));
heliosk.cu:	cudaMemset(Nxmin_d, 0, param.nbins * sizeof(int));
heliosk.cu:		cudaMalloc((void **) &K2_d, Nx * sizeof(double));
heliosk.cu://cudaMemGetInfo( &free_byte, &total_byte );
heliosk.cu:		cudaMalloc((void **) &V_d, param.nC * param.Nxb * sizeof(double));
heliosk.cu:		cudaMalloc((void **) &C_d, param.nC * sizeof(double));
heliosk.cu:		cudaMalloc((void **) &D_d, param.nC * sizeof(double));
heliosk.cu:		cudaDeviceSynchronize();
heliosk.cu:		error = cudaGetLastError();
heliosk.cu:			printf("Resampling Allocation error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:			cudaMemset(K2_d, 0, Nx * sizeof(double));
heliosk.cu:			cudaMemset(Nxmin_d, 0, param.nbins * sizeof(int));
heliosk.cu:cudaMemcpy(K2_h, K2_d, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:cudaMemcpy(K_h, K_d + iP * Nx, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:cudaDeviceSynchronize();
heliosk.cu:			cudaMemcpy(Nxmin_h, Nxmin_d, param.nbins * sizeof(int), cudaMemcpyDeviceToHost);
heliosk.cu:				cudaMemcpy(K_h + il, K_d + il + iP * Nx, param.nC * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:		cudaFree(V_d);
heliosk.cu:		cudaFree(C_d);
heliosk.cu:		cudaFree(D_d);
heliosk.cu:		cudaFree(K2_d);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("Resampling error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaEventRecord(tt2, 0);
heliosk.cu:	cudaEventSynchronize(tt2);
heliosk.cu:	cudaEventElapsedTime(&milliseconds, tt1, tt2);
heliosk.cu:	cudaEventRecord(tt1, 0);
heliosk.cu:			cudaMemcpy(K_h, K_d + iP * Nx, Nx * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("Write error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaEventRecord(tt2, 0);
heliosk.cu:	cudaEventSynchronize(tt2);
heliosk.cu:	cudaEventElapsedTime(&milliseconds, tt1, tt2);
heliosk.cu:	cudaEventRecord(tt1, 0);
heliosk.cu:		cudaMalloc((void **) &Tr_d, param.nbins * param.nTr * sizeof(double));
heliosk.cu:			cudaMemcpy(Tr_h, Tr_d, param.nbins * param.nTr * sizeof(double), cudaMemcpyDeviceToHost);
heliosk.cu:		cudaFree(Tr_d);
heliosk.cu:	cudaDeviceSynchronize();
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:		printf("Transmission error = %d = %s\n",error, cudaGetErrorString(error));
heliosk.cu:	cudaEventRecord(tt2, 0);
heliosk.cu:	cudaEventSynchronize(tt2);
heliosk.cu:	cudaEventElapsedTime(&milliseconds, tt1, tt2);
heliosk.cu:	cudaFree(K_d);
heliosk.cu:	cudaFree(Nxmin_d);
heliosk.cu:	error = cudaGetLastError();
heliosk.cu:	printf("Final error = %d = %s\n",error, cudaGetErrorString(error));
README.md:HELIOS-K is an opacity calculator, running on GPUs.
host.h:__host__ int readFileExomol(Line &L, int NL, FILE *dataFile, double *readBuffer_h, double *readBuffer_d, int readBufferSize, int readBufferN, int i, int vs, cudaStream_t *Stream){
host.h:	cudaStreamSynchronize(Stream[vs % def_rBs]);
host.h:	//cudaMemcpy(readBuffer_d + i * readBufferN, readBuffer_h + bSwap, Size * readBufferN * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpyAsync(readBuffer_d + i * readBufferN, readBuffer_h + bSwap, Size * readBufferN * sizeof(double), cudaMemcpyHostToDevice, Stream[vs % def_rBs]);
host.h:	cudaHostAlloc((void **) &L.iiLimitsA0_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsA1_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAL0_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAL1_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAR0_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAR1_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsB0_h, (n + def_nlB - 1)/ def_nlB * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsB1_h, (n + def_nlB - 1)/ def_nlB * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsC0_h, (n + def_nlC - 1)/ def_nlC * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsC1_h, (n + def_nlC - 1)/ def_nlC * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaMalloc((void **) &L.nu_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.S_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.Sf_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.S1_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.S1f_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.A_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.delta_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.EL_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.vy_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.vyf_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.va_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.vb_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.vcut2_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.ialphaD_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.n_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.Sort_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.ID_d, n * sizeof(int));
host.h:		cudaMalloc((void **) &L.plinth_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsA0_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsA1_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAL0_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAL1_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAR0_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAR1_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsB0_d, (n + def_nlB - 1)/ def_nlB * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsB1_d, (n + def_nlB - 1)/ def_nlB * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsC0_d, (n + def_nlC - 1)/ def_nlC * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsC1_d, (n + def_nlC - 1)/ def_nlC * sizeof(double));
host.h:	cudaMalloc((void **) &L.iiLimitsA0_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsA1_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAL0_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAL1_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAR0_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAR1_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsB0_d, (n + def_nlB - 1)/ def_nlB * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsB1_d, (n + def_nlB - 1)/ def_nlB * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsC0_d, (n + def_nlC - 1)/ def_nlC * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsC1_d, (n + def_nlC - 1)/ def_nlC * sizeof(long long int));
host.h:	cudaHostAlloc((void **) &L.iiLimitsAT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsALT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsART_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsBT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsCT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsAT_d, (void *)L.iiLimitsAT_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsALT_d, (void *)L.iiLimitsALT_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsART_d, (void *)L.iiLimitsART_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsBT_d, (void *)L.iiLimitsBT_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsCT_d, (void *)L.iiLimitsCT_m, 0);
host.h:	cudaHostAlloc((void **) &L.nu_h, n * sizeof(double), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.S_h, n * sizeof(double), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.A_h, n * sizeof(double), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.EL_h, n * sizeof(double), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsA0_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsA1_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAL0_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAL1_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAR0_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsAR1_h, (n + def_nlA - 1)/ def_nlA * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsB0_h, (n + def_nlB - 1)/ def_nlB * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsB1_h, (n + def_nlB - 1)/ def_nlB * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsC0_h, (n + def_nlC - 1)/ def_nlC * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsC1_h, (n + def_nlC - 1)/ def_nlC * sizeof(long long int), cudaHostAllocDefault);
host.h:	cudaMalloc((void **) &L.nu_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.S_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.Sf_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.S1_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.S1f_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.A_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.EL_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.vy_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.vyf_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.va_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.vb_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.vcut2_d, n * sizeof(float));
host.h:	cudaMalloc((void **) &L.ialphaD_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.n_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.Sort_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.ID_d, n * sizeof(int));
host.h:		cudaMalloc((void **) &L.plinth_d, n * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsA0_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsA1_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAL0_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAL1_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAR0_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsAR1_d, (n + def_nlA - 1)/ def_nlA * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsB0_d, (n + def_nlB - 1)/ def_nlB * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsB1_d, (n + def_nlB - 1)/ def_nlB * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsC0_d, (n + def_nlC - 1)/ def_nlC * sizeof(double));
host.h:	cudaMalloc((void **) &L.nuLimitsC1_d, (n + def_nlC - 1)/ def_nlC * sizeof(double));
host.h:	cudaMalloc((void **) &L.iiLimitsA0_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsA1_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAL0_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAL1_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAR0_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsAR1_d, (n + def_nlA - 1)/ def_nlA * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsB0_d, (n + def_nlB - 1)/ def_nlB * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsB1_d, (n + def_nlB - 1)/ def_nlB * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsC0_d, (n + def_nlC - 1)/ def_nlC * sizeof(long long int));
host.h:	cudaMalloc((void **) &L.iiLimitsC1_d, (n + def_nlC - 1)/ def_nlC * sizeof(long long int));
host.h:	cudaHostAlloc((void **) &L.iiLimitsAT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsALT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsART_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsBT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostAlloc((void **) &L.iiLimitsCT_m, 2 * sizeof(unsigned long long int), cudaHostAllocDefault);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsAT_d, (void *)L.iiLimitsAT_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsALT_d, (void *)L.iiLimitsALT_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsART_d, (void *)L.iiLimitsART_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsBT_d, (void *)L.iiLimitsBT_m, 0);
host.h:	cudaHostGetDevicePointer((void **)&L.iiLimitsCT_d, (void *)L.iiLimitsCT_m, 0);
host.h:	cudaMemcpy(L.nu_d, L.nu_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.S_d, L.S_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.vy_d, L.vy_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.A_d, L.A_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.delta_d, L.delta_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.EL_d, L.EL_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.ialphaD_d, L.ialphaD_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaMemcpy(L.n_d, L.n_h, NL * sizeof(double), cudaMemcpyHostToDevice);
host.h:	cudaFreeHost(L.iiLimitsA0_h);
host.h:	cudaFreeHost(L.iiLimitsA1_h);
host.h:	cudaFreeHost(L.iiLimitsAL0_h);
host.h:	cudaFreeHost(L.iiLimitsAL1_h);
host.h:	cudaFreeHost(L.iiLimitsAR0_h);
host.h:	cudaFreeHost(L.iiLimitsAR1_h);
host.h:	cudaFreeHost(L.iiLimitsB0_h);
host.h:	cudaFreeHost(L.iiLimitsB1_h);
host.h:	cudaFreeHost(L.iiLimitsC0_h);
host.h:	cudaFreeHost(L.iiLimitsC1_h);
host.h:	cudaFree(L.nu_d);
host.h:	cudaFree(L.S_d);
host.h:	cudaFree(L.Sf_d);
host.h:	cudaFree(L.S1_d);
host.h:	cudaFree(L.S1f_d);
host.h:	cudaFree(L.A_d);
host.h:	cudaFree(L.delta_d);
host.h:	cudaFree(L.EL_d);
host.h:	cudaFree(L.vy_d);
host.h:	cudaFree(L.vyf_d);
host.h:	cudaFree(L.va_d);
host.h:	cudaFree(L.vb_d);
host.h:	cudaFree(L.vcut2_d);
host.h:	cudaFree(L.ialphaD_d);
host.h:	cudaFree(L.n_d);
host.h:	cudaFree(L.Sort_d);
host.h:	cudaFree(L.ID_d);
host.h:	cudaFree(L.nuLimitsA0_d);
host.h:	cudaFree(L.nuLimitsA1_d);
host.h:	cudaFree(L.nuLimitsAL0_d);
host.h:	cudaFree(L.nuLimitsAL1_d);
host.h:	cudaFree(L.nuLimitsAR0_d);
host.h:	cudaFree(L.nuLimitsAR1_d);
host.h:	cudaFree(L.nuLimitsB0_d);
host.h:	cudaFree(L.nuLimitsB1_d);
host.h:	cudaFree(L.nuLimitsC0_d);
host.h:	cudaFree(L.nuLimitsC1_d);
host.h:		cudaFree(L.plinth_d);
host.h:	cudaFree(L.iiLimitsA0_d);
host.h:	cudaFree(L.iiLimitsA1_d);
host.h:	cudaFree(L.iiLimitsAL0_d);
host.h:	cudaFree(L.iiLimitsAL1_d);
host.h:	cudaFree(L.iiLimitsAR0_d);
host.h:	cudaFree(L.iiLimitsAR1_d);
host.h:	cudaFree(L.iiLimitsB0_d);
host.h:	cudaFree(L.iiLimitsB1_d);
host.h:	cudaFree(L.iiLimitsC0_d);
host.h:	cudaFree(L.iiLimitsC1_d);
host.h:	cudaFreeHost(L.iiLimitsAT_m);
host.h:	cudaFreeHost(L.iiLimitsALT_m);
host.h:	cudaFreeHost(L.iiLimitsART_m);
host.h:	cudaFreeHost(L.iiLimitsBT_m);
host.h:	cudaFreeHost(L.iiLimitsCT_m);
host.h:	cudaFreeHost(L.nu_h);
host.h:	cudaFreeHost(L.S_h);
host.h:	cudaFreeHost(L.A_h);
host.h:	cudaFreeHost(L.EL_h);
host.h:	cudaFreeHost(L.iiLimitsA0_h);
host.h:	cudaFreeHost(L.iiLimitsA1_h);
host.h:	cudaFreeHost(L.iiLimitsAL0_h);
host.h:	cudaFreeHost(L.iiLimitsAL1_h);
host.h:	cudaFreeHost(L.iiLimitsAR0_h);
host.h:	cudaFreeHost(L.iiLimitsAR1_h);
host.h:	cudaFreeHost(L.iiLimitsB0_h);
host.h:	cudaFreeHost(L.iiLimitsB1_h);
host.h:	cudaFreeHost(L.iiLimitsC0_h);
host.h:	cudaFreeHost(L.iiLimitsC1_h);
host.h:	cudaFree(L.nu_d);
host.h:	cudaFree(L.S_d);
host.h:	cudaFree(L.Sf_d);
host.h:	cudaFree(L.S1_d);
host.h:	cudaFree(L.S1f_d);
host.h:	cudaFree(L.A_d);
host.h:	cudaFree(L.vy_d);
host.h:	cudaFree(L.vyf_d);
host.h:	cudaFree(L.va_d);
host.h:	cudaFree(L.vb_d);
host.h:	cudaFree(L.vcut2_d);
host.h:	cudaFree(L.ialphaD_d);
host.h:	cudaFree(L.n_d);
host.h:	cudaFree(L.Sort_d);
host.h:	cudaFree(L.ID_d);
host.h:	cudaFree(L.nuLimitsA0_d);
host.h:	cudaFree(L.nuLimitsA1_d);
host.h:	cudaFree(L.nuLimitsAL0_d);
host.h:	cudaFree(L.nuLimitsAL1_d);
host.h:	cudaFree(L.nuLimitsAR0_d);
host.h:	cudaFree(L.nuLimitsAR1_d);
host.h:	cudaFree(L.nuLimitsB0_d);
host.h:	cudaFree(L.nuLimitsB1_d);
host.h:	cudaFree(L.nuLimitsC0_d);
host.h:	cudaFree(L.nuLimitsC1_d);
host.h:		cudaFree(L.plinth_d);
host.h:	cudaFree(L.iiLimitsA0_d);
host.h:	cudaFree(L.iiLimitsA1_d);
host.h:	cudaFree(L.iiLimitsAL0_d);
host.h:	cudaFree(L.iiLimitsAL1_d);
host.h:	cudaFree(L.iiLimitsAR0_d);
host.h:	cudaFree(L.iiLimitsAR1_d);
host.h:	cudaFree(L.iiLimitsB0_d);
host.h:	cudaFree(L.iiLimitsB1_d);
host.h:	cudaFree(L.iiLimitsC0_d);
host.h:	cudaFree(L.iiLimitsC1_d);
host.h:	cudaFreeHost(L.iiLimitsAT_m);
host.h:	cudaFreeHost(L.iiLimitsALT_m);
host.h:	cudaFreeHost(L.iiLimitsART_m);
host.h:	cudaFreeHost(L.iiLimitsBT_m);
host.h:	cudaFreeHost(L.iiLimitsCT_m);
resample.h:	cudaMemcpyToSymbol(wS_c, wS_h, 3 * sizeof(double), 0, cudaMemcpyHostToDevice);
voigt.h:	cudaMemcpyToSymbol(sLchi_c, sLchi_h, 17 * sizeof(float), 0, cudaMemcpyHostToDevice);
voigt.h:	cudaMemcpyToSymbol(useSubLorentzian_c, &useSubLorentzian, sizeof(int), 0, cudaMemcpyHostToDevice);
voigt.h:__host__ int Line6A_Call(Line L, Param param, double* KS_d, double * x_d, int il1, int NL, int nntt, int nk, int Nx, cudaStream_t Stream, int LR, int fK){
voigt.h:__host__ int Line6B_Call(Line L, Param param, double* KS_d, double * x_d, int il1, int NL, int nntt, int nk, int Nx, cudaStream_t Stream, int fK){
voigt.h:__host__ int Line6C_Call(Line L, Param param, double* KS_d, double * x_d, int il1, int NL, int nntt, int nk, int Nx, double a, double b, double c, cudaStream_t Stream, int fK){

```
