# https://github.com/padster/pyNeuroTrace

```console
setup.py:    packages=['pyneurotrace', 'pyneurotrace.gpu'],
setup.py:        "GPU": ["cupy"],
docs/source/installation.rst:GPU Supported functions use the Python Library Cupy. This library has the following requirements:
docs/source/installation.rst:* NVIDIA CUDA GPU with the Compute Capability 3.0 or larger.
docs/source/installation.rst:* CUDA Toolkit: v11.2 / v11.3 / v11.4 / v11.5 / v11.6 / v11.7 / v11.8 / v12.0 / v12.1 / v12.2 / v12.3 / v12.4
docs/source/installation.rst:   pip install pyNeuroTrace[GPU]
docs/source/installation.rst:If Cupy fails to build from the wheel using this command try installing Cupy first using a wheel that matches your CUDA Toolkit version ie:
docs/source/installation.rst:   pip install cupy-cuda12x
docs/source/overview.rst:   ├── gpu
docs/docs.md:If you wish to use optional GPU accelrated modules install `pyNeuroTrace` with this modification to the above command:
docs/docs.md:pip install pyNeuroTrace['GPU']
docs/docs.md:Or insure the `Cupy` is installed in your Python environment and that you have a CUDA enabled graphics card.
docs/docs.md:├── gpu
docs/build/html/searchindex.js:Search.setIndex({"alltitles": {"Events": [[3, "events"]], "Examples": [[0, "examples"]], "Files": [[4, "files"]], "Filters": [[5, "filters"]], "Indices and tables": [[1, "indices-and-tables"]], "Installation": [[2, "installation"]], "Modules": [[6, "modules"]], "Morphology": [[7, "morphology"]], "Notebook": [[8, "notebook"]], "Overview": [[10, "overview"]], "Table of Contents": [[1, null]], "Visualization": [[9, "visualization"]], "Welcome to pyNeuroTrace\u2019s documentation!": [[1, "welcome-to-pyneurotrace-s-documentation"]]}, "docnames": ["examples", "index", "installation", "modules/events", "modules/files", "modules/filters", "modules/index", "modules/morphology", "modules/notebook", "modules/viz", "overview"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["examples.rst", "index.rst", "installation.rst", "modules/events.rst", "modules/files.rst", "modules/filters.rst", "modules/index.rst", "modules/morphology.rst", "modules/notebook.rst", "modules/viz.rst", "overview.rst"], "indexentries": {"buildbranchidmap() (in module pyneurotrace.morphology)": [[7, "pyneurotrace.morphology.buildBranchIDMap", false]], "cusum() (in module pyneurotrace.events)": [[3, "pyneurotrace.events.cusum", false]], "deltafoverf0() (in module pyneurotrace.filters)": [[5, "pyneurotrace.filters.deltaFOverF0", false]], "ewma() (in module pyneurotrace.events)": [[3, "pyneurotrace.events.ewma", false]], "filepicker() (in module pyneurotrace.notebook)": [[8, "pyneurotrace.notebook.filePicker", false]], "folderpicker() (in module pyneurotrace.notebook)": [[8, "pyneurotrace.notebook.folderPicker", false]], "kymograph() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.kymograph", false]], "load2pdata() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.load2PData", false]], "loadhybrid() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.loadHybrid", false]], "loadkymograph() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.loadKymograph", false]], "loadmetadata() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.loadMetadata", false]], "loadnodexyz() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.loadNodeXYZ", false]], "loadsinglestep() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.loadSingleStep", false]], "loadtreestructure() (in module pyneurotrace.files)": [[4, "pyneurotrace.files.loadTreeStructure", false]], "matchedfilter() (in module pyneurotrace.events)": [[3, "pyneurotrace.events.matchedFilter", false]], "newfilepicker() (in module pyneurotrace.notebook)": [[8, "pyneurotrace.notebook.newFilePicker", false]], "nndsmooth() (in module pyneurotrace.filters)": [[5, "pyneurotrace.filters.nndSmooth", false]], "okada() (in module pyneurotrace.filters)": [[5, "pyneurotrace.filters.okada", false]], "planaranimation() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.planarAnimation", false]], "plotaveragepoststimintensity() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.plotAveragePostStimIntensity", false]], "plotaveragepoststimtransientparams() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.plotAveragePostStimTransientParams", false]], "plotbasetipscatter() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.plotBaseTipScatter", false]], "plotintensity() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.plotIntensity", false]], "plotline() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.plotLine", false]], "plotplanarstructure() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.plotPlanarStructure", false]], "scrollinganimation() (in module pyneurotrace.viz)": [[9, "pyneurotrace.viz.scrollingAnimation", false]], "showtabs() (in module pyneurotrace.notebook)": [[8, "pyneurotrace.notebook.showTabs", false]], "thresholdevents() (in module pyneurotrace.events)": [[3, "pyneurotrace.events.thresholdEvents", false]], "treepostprocessing() (in module pyneurotrace.morphology)": [[7, "pyneurotrace.morphology.treePostProcessing", false]], "treetofilotipandbase() (in module pyneurotrace.morphology)": [[7, "pyneurotrace.morphology.treeToFiloTipAndBase", false]]}, "objects": {"pyneurotrace.events": [[3, 0, 1, "", "cusum"], [3, 0, 1, "", "ewma"], [3, 0, 1, "", "matchedFilter"], [3, 0, 1, "", "thresholdEvents"]], "pyneurotrace.files": [[4, 0, 1, "", "load2PData"], [4, 0, 1, "", "loadHybrid"], [4, 0, 1, "", "loadKymograph"], [4, 0, 1, "", "loadMetadata"], [4, 0, 1, "", "loadNodeXYZ"], [4, 0, 1, "", "loadSingleStep"], [4, 0, 1, "", "loadTreeStructure"]], "pyneurotrace.filters": [[5, 0, 1, "", "deltaFOverF0"], [5, 0, 1, "", "nndSmooth"], [5, 0, 1, "", "okada"]], "pyneurotrace.morphology": [[7, 0, 1, "", "buildBranchIDMap"], [7, 0, 1, "", "treePostProcessing"], [7, 0, 1, "", "treeToFiloTipAndBase"]], "pyneurotrace.notebook": [[8, 0, 1, "", "filePicker"], [8, 0, 1, "", "folderPicker"], [8, 0, 1, "", "newFilePicker"], [8, 0, 1, "", "showTabs"]], "pyneurotrace.viz": [[9, 0, 1, "", "kymograph"], [9, 0, 1, "", "planarAnimation"], [9, 0, 1, "", "plotAveragePostStimIntensity"], [9, 0, 1, "", "plotAveragePostStimTransientParams"], [9, 0, 1, "", "plotBaseTipScatter"], [9, 0, 1, "", "plotIntensity"], [9, 0, 1, "", "plotLine"], [9, 0, 1, "", "plotPlanarStructure"], [9, 0, 1, "", "scrollingAnimation"]]}, "objnames": {"0": ["py", "function", "Python function"]}, "objtypes": {"0": "py:function"}, "terms": {"": 5, "0": [3, 5, 7, 9], "005": 9, "028": 3, "05": 9, "1": [3, 4, 5, 9], "10": 9, "11": [4, 5], "153": 5, "162": 5, "2": [3, 5], "2011": 5, "2013": 5, "2016": 5, "28": 5, "3": [5, 9], "39": 3, "5": 7, "6": 5, "60": 9, "75": 5, "8": 9, "A": [3, 5], "If": 2, "In": 5, "Or": 2, "The": [4, 8], "These": [5, 7], "abov": [3, 4], "acceler": 2, "accumul": 3, "across": 9, "ad": 7, "addit": 9, "after": [3, 9], "all": [4, 9], "alpha": 9, "amplitud": 3, "an": [3, 4, 5, 6, 9, 10], "analyz": [3, 5], "anim": 9, "aod": 7, "appli": 3, "ar": [4, 5, 7], "area": 8, "argument": 9, "around": 9, "arrai": [3, 4, 5, 7, 9], "avail": 4, "averag": [3, 5, 9], "ax": 9, "axi": 9, "b": 4, "background": 9, "bar": 8, "base": [7, 9], "baselin": 5, "basetrac": 9, "befor": [3, 9], "being": 4, "bgcolor": 9, "big": 4, "biophoton": 5, "black": 9, "block": 4, "bool": [4, 7, 8, 9], "box": 8, "branch": [4, 7, 9], "branchid": [7, 9], "branchidmap": 7, "build": 7, "buildbranchidmap": 7, "c": 4, "calcium": 5, "calcul": [3, 5, 7], "can": 2, "card": 2, "chang": 5, "check": 9, "chen": 5, "color": 9, "computation": 5, "concaten": 4, "confid": 3, "consid": 3, "constant": 5, "contain": [3, 4, 7], "convers": 9, "convert": 4, "convertxyztopx": 4, "coordin": [7, 9], "core": 6, "cortic": 5, "creat": 9, "cuda": 2, "cumul": 3, "cupi": 2, "custom": [7, 9], "cusum": 3, "cusum_data": 3, "dark": 9, "data": [3, 4, 5, 7, 8, 9], "decai": [3, 5], "decayr": 3, "deconvolut": 5, "default": [3, 4, 5, 7, 8, 9], "defaultpath": 8, "deltaf_over_f0": 5, "deltafoverf0": 5, "dendrit": 5, "desir": 3, "detail": 4, "detect": 3, "detector": 3, "df": 9, "dfof": 9, "dialog": 8, "dict": [4, 7, 8, 9], "dictionari": [4, 7, 9], "displai": 8, "distanc": 7, "document": 3, "drift": 9, "e": 4, "e0157595": 5, "each": [3, 8], "effici": 5, "en": 3, "enabl": 2, "end": 4, "ensur": 2, "entir": 4, "environ": 2, "event": [1, 6, 10], "everi": 4, "evok": 5, "ewma": [3, 5], "exampl": 1, "exist": 3, "experi": 4, "experiment": [4, 9], "exponenti": [3, 5], "exponential_moving_averag": 3, "expt": 4, "extens": 8, "f0": 9, "factor": 9, "fals": [4, 7, 8, 9], "far": 3, "fast": 5, "file": [1, 6, 8, 10], "filepick": 8, "filodist": 7, "filopodia": [7, 9], "filter": [1, 3, 6, 8, 10], "filtered_data": 5, "finaltracebranch": 7, "finaltraceid": 7, "first": 4, "flag": [4, 7, 8, 9], "flatten": 9, "flip": 9, "flipi": 9, "float": [3, 4, 5, 7, 9], "fluoresc": 5, "fname": 8, "folder": [4, 8], "folderpick": 8, "forc": 9, "forcestimwidth": 9, "format": 9, "from": [3, 4, 9], "function": [3, 5, 6, 7, 8], "g": 4, "getplanarxyzfromvolum": 4, "github": 0, "given": [3, 7], "gpu": [2, 10], "graphic": 2, "h": 5, "haa": 5, "hasloc": 4, "have": [2, 4], "height": 9, "heightinch": 9, "here": 6, "how": 3, "http": 3, "hybrid": [4, 9], "hybriddata": 4, "hybridstimcolour": 9, "hz": [3, 4, 5, 9], "i": [2, 3, 4, 5, 6, 7, 8, 9, 10], "id": [4, 7, 9], "identifi": 7, "ikegaya": 5, "imag": [5, 7], "inch": 9, "index": [1, 9], "indic": [3, 4, 7], "instal": 1, "int": [3, 4, 5, 7, 9], "intens": [4, 9], "interact": 8, "interp": 4, "ipython": 8, "ishikawa": 5, "iter": 5, "iterfunc": 5, "jia": 5, "journal": 5, "jupyt": 0, "k": 5, "keep": 3, "keyword": 9, "konnerth": 5, "kwarg": 9, "kymodata": [4, 9], "kymograph": [4, 9], "kymopath": 4, "l": 5, "label": 9, "laser": 5, "librari": 10, "likelihood": 3, "limit": 9, "limitsec": 9, "line": 9, "linealpha": 9, "list": [4, 7, 8, 9], "load": 4, "load2pdata": 4, "loadhybrid": 4, "loadkymodata": 4, "loadkymograph": 4, "loadmetadata": 4, "loadnodexyz": 4, "loadsinglestep": 4, "loadtreestructur": 4, "locat": [4, 7, 9], "log": 3, "look": 0, "low": 5, "m": 5, "mani": 4, "map": [4, 7], "match": 3, "matched_filt": 3, "matchedfilt": 3, "matrix": 4, "mean": [3, 5], "messag": 8, "metadata": 4, "metapath": 4, "meter": [4, 9], "method": 3, "mf": 3, "mf_data": 3, "microscop": 7, "microscopi": 5, "minbelowbefor": 3, "minimum": [3, 5], "modif": 2, "modul": [1, 2, 3, 10], "morphologi": [1, 6, 10], "move": [3, 5], "movement": 3, "moving_averag": 3, "multipl": 8, "n": 5, "natur": 5, "neg": 5, "neuron": [4, 5, 7], "new": [3, 8], "newfilepick": 8, "nndsmooth": 5, "node": [4, 7, 9], "nodeid": [4, 7], "nodexyz": [7, 9], "nois": [3, 5], "non": [3, 5], "none": [5, 8, 9], "normal": 4, "normalizexyz": 4, "notebook": [0, 1, 6, 10], "np": 4, "number": [3, 4], "object": 9, "obtain": 4, "occur": 3, "off": 9, "offset": 9, "okada": 5, "one": [5, 8], "onli": 3, "option": [2, 3, 4, 5, 7, 8, 9], "org": 3, "out": 4, "output": [3, 8], "over": [3, 5], "overlai": 9, "overlaystim": 9, "overview": [1, 6], "pad": 9, "page": 1, "palett": 9, "paramet": [3, 4, 5, 7, 8, 9], "parent": 4, "pars": 4, "path": [4, 8, 9], "per": 4, "percentag": 9, "perform": [3, 5], "photon": 5, "pick": 8, "picker": 8, "pip": 2, "pixel": [4, 9], "pixelmet": 9, "planar": [4, 9], "planaranim": 9, "pleas": 0, "plo": 5, "plot": 9, "plotaveragepoststimintens": 9, "plotaveragepoststimtransientparam": 9, "plotbasetipscatt": 9, "plotintens": 9, "plotlin": 9, "plotplanarstructur": 9, "plu": 4, "podgorski": 5, "poi": 9, "point": [3, 4], "posit": [4, 9], "possibl": 4, "post": 9, "previou": 3, "process": [4, 7], "progress": 8, "progressbar": 8, "prompt": 8, "protocol": 5, "pxlpernod": 4, "pyneurotrac": [2, 3, 4, 5, 7, 8, 9, 10], "python": 2, "r": 4, "radiu": 9, "rate": [3, 4, 5, 9], "ratio": 3, "raw": [4, 7, 9], "rawdata": 4, "reconstruct": 7, "record": 4, "reduc": 5, "remain": 4, "reorder": 7, "repositori": 0, "repres": [7, 9], "rest": 4, "result": 4, "return": [3, 4, 5, 7, 8, 9], "rise": 3, "riser": 3, "rochefort": 5, "roll": 3, "root": [4, 7, 9], "rootid": [4, 7, 9], "rootpath": 4, "row": [3, 4], "rscan_metadata": 4, "same": 8, "sampl": [3, 4, 5, 9], "save": [8, 9], "savepath": 9, "scale": 9, "scan": [4, 5, 9], "scatter": 9, "scroll": 9, "scrollinganim": 9, "seaborn": 9, "search": 1, "secaft": 9, "secbefor": 9, "second": 9, "see": 3, "select": 8, "sensori": 5, "separ": 4, "seri": 4, "set": 8, "shot": 5, "should": 4, "show": [8, 9], "showontabfunc": 8, "showtab": 8, "signal": [3, 5], "singl": 4, "size": [3, 4], "slack": 3, "smooth": [3, 5, 9], "smoothed_data": [3, 5], "sourc": 4, "specifi": 7, "split": [7, 9], "splitatbranch": 7, "stack": 4, "start": [4, 7, 8], "step": 4, "stepdata": 4, "steppath": 4, "stim": [4, 9], "stimindic": 4, "stimoffidx": 9, "stimoffset": 9, "stimonidx": 9, "stimulu": [4, 9], "stimxi": 9, "str": [8, 9], "string": 4, "strongli": 3, "structur": [4, 7, 9], "subtract": 3, "sum": 3, "support": 4, "t": 5, "t0": 5, "t1": 5, "t2": 5, "tab": 8, "tau": 5, "tempor": 5, "test": 3, "them": 4, "thi": [2, 4, 10], "threshold": [3, 7], "thresholdev": 3, "tick": 9, "time": [4, 5, 9], "timeseri": 5, "tip": [7, 9], "tiptrac": 9, "titl": [8, 9], "tool": [4, 5, 8, 9], "trace": [4, 7, 9], "tracedata": 9, "traceid": 7, "transient": 9, "tree": [4, 7, 9], "treepath": 4, "treepostprocess": 7, "treetofilotipandbas": 7, "true": [4, 9], "tupl": 9, "turn": 3, "two": 5, "txt": 4, "type": [3, 4, 5, 7, 8, 9], "up": 8, "us": [2, 3, 7, 10], "user": 8, "v": [3, 9], "valu": [3, 9], "versu": 3, "visual": [1, 6], "vivo": 5, "viz": [9, 10], "viztrac": 9, "volum": 4, "volumexyzsourc": 4, "weight": 3, "well": 3, "whether": [4, 7], "which": 4, "width": 9, "widthinch": 9, "wiki": 3, "wikipedia": 3, "window": [3, 5], "windows": 3, "wish": 2, "within": 8, "x": [4, 5, 9], "xax": 9, "xy": 4, "xysizem": 4, "xyz": [4, 7, 9], "xyzspath": 4, "y": [4, 5, 9], "yax": 9, "ye": 3, "you": 2, "your": 2, "ypad": 9, "ytickpct": 9, "ytickscal": 9, "ytitl": 9, "z": [4, 9], "zstackloc": 4}, "titles": ["Examples", "Welcome to pyNeuroTrace\u2019s documentation!", "Installation", "Events", "Files", "Filters", "Modules", "Morphology", "Notebook", "Visualization", "Overview"], "titleterms": {"": 1, "content": 1, "document": 1, "event": 3, "exampl": 0, "file": 4, "filter": 5, "indic": 1, "instal": 2, "modul": 6, "morphologi": 7, "notebook": 8, "overview": 10, "pyneurotrac": 1, "tabl": 1, "visual": 9, "welcom": 1}})
docs/build/html/_sources/overview.rst.txt:   ├── gpu
docs/build/html/_sources/installation.rst.txt:If you wish to use optional GPU-accelerated modules, install pyNeuroTrace with this modification:
docs/build/html/_sources/installation.rst.txt:   pip install pyNeuroTrace[GPU]
docs/build/html/_sources/installation.rst.txt:Or ensure that `Cupy` is installed in your Python environment and that you have a CUDA-enabled graphics card.
pytest.ini:norecursedirs = .git __pycache__ node_modules pyneurotrace/gpu
README.md:GPU Supported functions use the Python Library Cupy. This library has the following requirements:
README.md:* NVIDIA CUDA GPU with the Compute Capability 3.0 or larger.
README.md:* CUDA Toolkit: v11.2 / v11.3 / v11.4 / v11.5 / v11.6 / v11.7 / v11.8 / v12.0 / v12.1 / v12.2 / v12.3 / v12.4
README.md:pip install pyNeuroTrace[GPU]
README.md:If Cupy fails to build from the wheel using this command try installing Cupy first using a wheel that matches your CUDA Toolkit version ie:
README.md:pip install cupy-cuda12x
paper/paper.bib:  title        = "CuPy: A NumPy-Compatible Library for NVIDIA GPU Calculations",
paper/paper.md:Many neuroscience labs using optophysiological methods, such as sampling neural activity using two-photon microscopy or fiber photometry, typically must create and constantly adjust functions and filters to analyze raw recordings. Currently, there is limited standardization for approaches for signal processing, with techniques and algorithms scattered throughout the literature such as [@Friedrich2017], requiring substantial framework overhead [@Giovannucci2019] or implemented in various programming languages other than Python [@Ortega2024]. Additionally, other popular tools used to extract calcium signals from imaging experiments often have limited signal processing utilities, lacking functions for calculating $\Delta F/F$, forcing users to rely on independent methods [@Pachitariu2017]. Our library, `pyNeuroTrace`, seeks to address these problems by providing an analytic package written purely in Python specifically for neuronal activity data sets. Our package includes a collection of filters and algorithms relevant to optophysiological analysis that are implemented in a generalizable manner for time series data sets in either 1D arrays or a collection of recordings in 2D arrays. Additionally, with the increase in acquisition rates of new imaging techniques, we have implemented a subset of these algorithms using GPU-compatible code to significantly increase processing speeds to accommodate large datasets collected, such as those from large population sampling or ultra-fast kilohertz sampling rates. 
paper/paper.md:# GPU Acceleration
paper/paper.md:Several of the filters in `pyNeuroTrace` have been rewritten to be almost entirely vectorized in their calculations. The benefit is more noticeable when comparing the difference in performance while using large data sets, such as those generated using a longer time series or faster acquisition rates. These vectorized implementations gain further speed by being executed on a GPU using the Cupy Python library [@cupy_learningsys2017]. The GPU-accelerated filters can be imported from the `pyneurotrace.gpu.filters` module, and a CUDA-compatible graphics card is required for their execution. This functionality is becoming increasingly crucial as acquisition rates increase for kilohertz imaging of activity [@Zhang2019], which can generate arrays of hundreds of thousands of data points in just a few minutes of recording. \autoref{fig:CPUvsGPU} shows the difference in calculating arrays of various sizes using either the CPU or vectorized GPU-based approach of the $\Delta F/F$ function. The CPU used in these calculations was an Intel i5-9600K with six 4.600GHz cores; the GPU was an NVIDIA GeForce RTX 4070 with CUDA Version 12.3. When compared, the GPU calculation was on average in the order of 100 times faster on time series up to 100,000 points in size.
paper/paper.md:![Comparison between $\Delta F/F$ with EWMA calculations for different array sizes using either the CPU (blue) or GPU (orange). \label{fig:CPUvsGPU}](docs/img/dffCalculationCPUvsGPU_log.png)
paper/paper.md:![Overlay of the EWMA calculations using the CPU implementation and GPU approximation in red and blue. The difference in values from the output is also plotted. The EWMA traces diverge after the initial window length of the GPU version's kernel, but never by more than a factor of 1e-11. \label{fig:ewmaCPUvsGPU}](docs/img/ewma_CPUvsGPU.png)
paper/paper.md:To demonstrate the differences between the CPU and GPU implementations of the EWMA calculations were performed on an array of random values \autoref{fig:ewmaCPUvsGPU}. These were generated from the same array using the respective decays for either implementation using the time constant of 50 milliseconds and a sampling rate of 2kHz. Depending on user parameters, the difference between the two outputs typically ranges in magnitude from  1e-16 to 1e-12. These discrepancies can also be attributed to differences in floating-point number accuracy between CPU and GPU calculations.
paper/paper.md:Single-cell electroporation (SCE) was used to label individual cells with fluorescent calcium indicators [@Haas2001]. A single tectal cell was transfected *in vivo* using SCE with a GCaMP6m plasmid \autoref{fig:heatmap}. In brief, the tadpole was anesthetized using 0.02% MS-222 in Steinberg's solution. A pulled glass pipette filled with 1 $\mu g/\mu l$ of plasmid DNA was stimulated using an Axoporator 800A electroporator (Molecular Devices). The electroporator parameters were set to 1 ms, -40 V pulses at 300 Hz for 300 ms. In another tadpole, an individual tectal cell was loaded with 2 mM of CAL-590 3000 Dextran (AAT Bioquest) \autoref{fig:CPUvsGPU}. The parameters for the dye electroporation were set to 1 ms, -40 V pulses at 900 Hz for 50 ms.
paper/paper.md:Neuronal activity recordings were performed using two-photon microscopy. All animals were reversibly paralyzed by bath application of 2 mM pancuronium dibromide for 5 minutes (Tocris) before being transferred to a custom imaging chamber [@Sakaki2020]. The GCaMP6m expressing neuron was imaged using a custom AOD-based RAMP microscope previously described [@Sakaki2020]. A Ti:Sapphire laser (Chameleon Vision II, Coherent) tuned to 910 nm was used for two-photon excitation, and emitted light was captured using a 60x, 1.1 NA water-immersion objective (LUMPL, Olympus). Tectal cells filled with CAL-590 AM were imaged using a custom microscope built from a commercial kit [@mbfSLAP2]. The excitation source was a 1030 nm custom Ytterbium-doped fiber laser with an average power of 68 W, 150 fs pulse width, and 40 MHz repetition rate (Tangerine-SP, Amplitude). Full-field raster imaging was collected at 13.5 Hz through a 25x 1.0 NA water-immersion objective (HC IRAPO, Leica) \autoref{fig:traces}. The microscope's integrated scan mode was used to capture calcium signals at 2 kHz from a branch of a neuron labeled with CAL-590 3k Dextran \autoref{fig:CPUvsGPU}. All signal processing was performed using pyNeuroTrace.
pyneurotrace/gpu/events.py:    This implementation allows for the EWMA to be calculated on GPUs. 
pyneurotrace/__init__.py:    from . import gpu
pyneurotrace/__init__.py:    gpu = None
pyproject.toml:GPU = ["cupy"]

```
